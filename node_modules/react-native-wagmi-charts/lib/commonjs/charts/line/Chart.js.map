{"version":3,"sources":["Chart.tsx"],"names":["LineChartDimensionsContext","React","createContext","width","height","pointWidth","parsedPath","path","area","shape","d3Shape","curveBumpX","gutter","pathWidth","screenWidth","Dimensions","get","LineChart","displayName","children","yGutter","id","absolute","props","yDomain","xLength","xDomain","useContext","LineChartContext","data","useMemo","allowedWidth","length","dataLength","contextValue","styles","style","StyleSheet","create","position"],"mappings":"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","sourcesContent":["import * as React from 'react';\n// @ts-ignore\nimport * as d3Shape from 'd3-shape';\nimport { Dimensions, StyleSheet, View, ViewProps } from 'react-native';\nimport { LineChartContext } from './Context';\nimport { LineChartIdProvider, useLineChartData } from './Data';\n\nimport { getArea, getPath } from './utils';\nimport { parse, Path } from 'react-native-redash';\n\nexport const LineChartDimensionsContext = React.createContext({\n  width: 0,\n  height: 0,\n  pointWidth: 0,\n  parsedPath: {} as Path,\n  path: '',\n  area: '',\n  shape: d3Shape.curveBumpX,\n  gutter: 0,\n  pathWidth: 0,\n});\n\ntype LineChartProps = ViewProps & {\n  children: React.ReactNode;\n  yGutter?: number;\n  width?: number;\n  height?: number;\n  shape?: unknown;\n  /**\n   * If your `LineChart.Provider` uses a dictionary with multiple IDs for multiple paths, then this field is required.\n   */\n  id?: string;\n  absolute?: boolean;\n};\n\nconst { width: screenWidth } = Dimensions.get('window');\n\nLineChart.displayName = 'LineChart';\n\nexport function LineChart({\n  children,\n  yGutter = 16,\n  width = screenWidth,\n  height = screenWidth,\n  shape = d3Shape.curveBumpX,\n  id,\n  absolute,\n  ...props\n}: LineChartProps) {\n  const { yDomain, xLength, xDomain } = React.useContext(LineChartContext);\n  const { data } = useLineChartData({\n    id,\n  });\n\n  const pathWidth = React.useMemo(() => {\n    let allowedWidth = width;\n    if (xLength > data.length) {\n      allowedWidth = (width * data.length) / xLength;\n    }\n    return allowedWidth;\n  }, [data.length, width, xLength]);\n\n  const path = React.useMemo(() => {\n    if (data && data.length > 0) {\n      return getPath({\n        data,\n        width: pathWidth,\n        height,\n        gutter: yGutter,\n        shape,\n        yDomain,\n        xDomain,\n      });\n    }\n    return '';\n  }, [data, pathWidth, height, yGutter, shape, yDomain, xDomain]);\n\n  const area = React.useMemo(() => {\n    if (data && data.length > 0) {\n      return getArea({\n        data,\n        width: pathWidth,\n        height,\n        gutter: yGutter,\n        shape,\n        yDomain,\n      });\n    }\n    return '';\n  }, [data, pathWidth, height, yGutter, shape, yDomain]);\n\n  const dataLength = data.length;\n  const parsedPath = React.useMemo(() => parse(path), [path]);\n  const pointWidth = React.useMemo(\n    () => width / (dataLength - 1),\n    [dataLength, width]\n  );\n\n  const contextValue = React.useMemo(\n    () => ({\n      gutter: yGutter,\n      parsedPath,\n      pointWidth,\n      area,\n      path,\n      width,\n      height,\n      pathWidth,\n      shape,\n    }),\n    [\n      yGutter,\n      parsedPath,\n      pointWidth,\n      area,\n      path,\n      width,\n      height,\n      pathWidth,\n      shape,\n    ]\n  );\n\n  return (\n    <LineChartIdProvider id={id}>\n      <LineChartDimensionsContext.Provider value={contextValue}>\n        <View {...props} style={[absolute && styles.absolute, props.style]}>\n          {children}\n        </View>\n      </LineChartDimensionsContext.Provider>\n    </LineChartIdProvider>\n  );\n}\n\nconst styles = StyleSheet.create({\n  absolute: {\n    position: 'absolute',\n  },\n});\n"]}